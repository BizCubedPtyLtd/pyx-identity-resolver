@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

!define DEVICONS https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/master/devicons2
!include DEVICONS/nodejs.puml

!define FONTAWESOME https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/master/font-awesome-5
!include FONTAWESOME/users.puml
!include FONTAWESOME/server.puml

!define AWS https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v18.0/dist
!include AWS/AWSCommon.puml
!include AWS/Storage/SimpleStorageService.puml

title C4 Container Diagram\n(minimal scenario)

System_Ext(RegistryManager, "Registry Management", "Fact Authority for an identity system", $sprite="server")

System_Boundary(s1, "Identity Resolver") {
  Container(app_gw, "Application Gateway", "reverse proxy, SSL termination, load balancer, etc")
  Container(vpn, "Virtual Private Network", "VPN/VPC")
  Container(api_app, "API Application", "TypeScript on LCX/Lambda", $sprite="nodejs")
  SimpleStorageService(obj_store, "Object Storage", "minio, S3 or equivalent", "json data persistance")
}

Person(AnonymousUser, "Anonymous User", "Finds and uses identifiers to discover further information", $sprite="users")
Rel_D(AnonymousUser, app_gw, "Uses identifiers to discover further information", "HTTPS")
Rel_D(app_gw, api_app, "REST", "HTTP")
Rel_D(api_app, obj_store, "Uses", "read/write")

Rel_U(RegistryManager, vpn, "Securely manage identity data", "SSL")
Rel_U(vpn, api_app, "Create and maintain identities", "HTTP")
Rel_U(vpn, api_app, "Maintain links associated with an identity", "HTTP")
Rel_R(vpn, obj_store, "Manage data", "bulk update, backup and recovery, etc")

@enduml
